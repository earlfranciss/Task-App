# Uses node version 22 as our base image
FROM node:22 AS build

# Goes to the app directory
WORKDIR /app

# Copy package.json and package-lock.json
COPY package*.json ./

# Install app dependencies
# RUN keyword happens when the image is BUILDING
RUN npm install

# Copy the rest of your code into the container
COPY . .

# Set port environment variable
ENV PORT=5173

# Expose the port so our computer can access it
# Tells Docker to use this port
EXPOSE 5173

ENV VITE_API_URL=http://localhost:5006
# Run the app
# CMD keyword is used to START the container AFTER building
# !Important: You can only have one CMD command in a dockerfile
CMD [ "npm", "run", "dev", "--", "--host"]

# Build Docker
# In terminal, use "docker build -t (tag or name) docker_example . (destination - current dir)"

# Run the container
# docker run -p (port forwarding) 9000:9000 (Computer Port:Container Port) docker_example

# cd frontend
# docker build -t task-frontend .
# docker run -p 5173:80 task-frontend
#docker-compose up --build